# Run Jupyter MCP Server

## Run with Python

Clone the repository and use `pip install -e .` or just install the `jupyter-mcp-server package` from PyPI with `pip install jupyter-mcp-server`.

Then, you can start JupyterLab and Jupyter MCP Server with the following commands.

```bash
make jupyterlab
```

```bash
make start-streamable-http
```

## Run with Docker

You can also run the Jupyter MCP Server using Docker. Use the following command to start the server on MacOS.

```bash
docker run --network=host -e ROOM_URL="http://localhost:8888" -p 4040:4040 datalayer/jupyter-mcp-server:latest --transport streamable-http
```

:::note

You can set the `ROOM_URL` (JupyterLab Server URL), `RUNTIME_TOKEN`, and `ROOM_ID` environment variables to configure the server with the `-e` option in the `docker run` command. If not set, the defaults will be used:

- `ROOM_URL`: `http://host.docker.internal:8888`
- `RUNTIME_TOKEN`: `MY_TOKEN`
- `ROOM_ID`: `notebook.ipynb`

:::

Use the following command to start the server on Linux.

```bash
docker run --network=host -e ROOM_URL="http://localhost:8888" -p 4040:4040 datalayer/jupyter-mcp-server:latest --transport streamable-http
```

## Run with Smithery

To install Jupyter MCP Server for Claude Desktop automatically via [Smithery](https://smithery.ai/server/@datalayer/jupyter-mcp-server):

```bash
npx -y @smithery/cli install @datalayer/jupyter-mcp-server --client claude
```

## Configuration

Check the help for the Jupyter MCP Server to see the available options.

```bash
jupyter-mcp-server start --help

Usage: jupyter-mcp-server start [OPTIONS]

  Start the Jupyter MCP Server with a transport.

Options:
  --transport [stdio|streamable-http]
                                  The transport to use for the MCP Server.
                                  Defaults to 'stdio'.
  --provider [jupyter|datalayer]  The provider to use for the room and
                                  runtime. Defaults to 'jupyter'.
  --runtime-url TEXT              The runtime URL to use. For the jupyter
                                  provider, this is the Jupyter server URL.
                                  For the datalayer provider, this is the
                                  Datalayer runtime URL.
  --runtime-token TEXT            The runtime token to use for authentication
                                  with the provider. If not provided, the
                                  provider should accept anonymous requests.
  --start-new-runtime BOOLEAN     Start a new runtime or use an existing one.
  --runtime-id TEXT               The kernel ID to use. If not provided, a new
                                  kernel should be started.
  --room-url TEXT                 The room URL to use. For the jupyter
                                  provider, this is the Jupyter server URL.
                                  For the datalayer provider, this is the
                                  Datalayer room URL.
  --room-id TEXT                  The room id to use. For the jupyter
                                  provider, this is the notebook path. For the
                                  datalayer provider, this is the notebook
                                  path.
  --room-token TEXT               The room token to use for authentication
                                  with the provider. If not provided, the
                                  provider should accept anonymous requests.
  --port INTEGER                  The port to use for the Streamable HTTP
                                  transport. Ignored for stdio transport.
  --help                          Show this message and exit.
```

For example, you can start the MCP Server with the following command.

```bash
jupyter-mcp-server --transport streamable-http --runtime-token MY_TOKEN --room-url http://localhost:8888 --start-new-runtime false
```

Only after you can start a local JupyterLab and open a Notebook with a Runtime.

```bash
make jupyterlab
```

Then, you can assign a room and runtime via the `/connect` endpoint.

```bash
curl -X PUT \
  -H "Content-Type: application/json" \
  -d '{"kernel_id": "94438bd9-b5ab-4497-9011-4f9f629dc472", "room_id": "notebook.ipynb", "server_url": "http://localhost:8888", "token": "MY_TOKEN", "provider": "jupyter"}' \
  http://localhost:4040/api/connect
```
