# As a Standalone Server

## 1. Start JupyterLab

### Environment setup

Make sure you have the following packages installed in your environment. The collaboration package is needed as the modifications made on the notebook can be seen thanks to [Jupyter Real Time Collaboration](https://jupyterlab.readthedocs.io/en/stable/user/rtc.html).

```bash
pip install jupyterlab==4.4.1 jupyter-collaboration==4.0.2 ipykernel
pip uninstall -y pycrdt datalayer_pycrdt
pip install datalayer_pycrdt==0.12.17
```

### JupyterLab start

Then, start JupyterLab with the following command.

```bash
jupyter lab --port 8888 --IdentityProvider.token MY_TOKEN --ip 0.0.0.0
```

You can also run `make jupyterlab` if you cloned the repository.

:::note

The `--ip` is set to `0.0.0.0` to allow the MCP Server running in a Docker container to access your local JupyterLab.

:::

:::info
For JupyterHub:
- Set the environment variable `JUPYTERHUB_ALLOW_TOKEN_IN_URL=1` in the single-user environment.
- Ensure your API token (`MY_TOKEN`) is created with `access:servers` scope in the Hub.
:::

## 2. Setup Jupyter MCP Server

Jupyter MCP Server also supports streamable HTTP transport, which allows you to connect to the Jupyter MCP Server using a URL. To start the server, you can either use `python` or `docker`. The server will listen on port `4040`, you can access it via http://localhost:4040.

### Run the Jupyter MCP Server

#### Run with Python

Clone the repository and use `pip install -e .` or just install the `jupyter-mcp-server package` from PyPI with `pip install jupyter-mcp-server`.

Then, you can start Jupyter MCP Server with the following commands.

```bash
# make start
jupyter-mcp-server start \
	  --transport streamable-http \
	  --document-url http://localhost:8888 \
	  --document-id notebook.ipynb \
	  --document-token MY_TOKEN \
	  --runtime-url http://localhost:8888 \
	  --start-new-runtime true \
	  --runtime-token MY_TOKEN \
	  --port 4040
```

#### Run with Docker

:::note

  You can set the `DOCUMENT_URL` (JupyterLab Server URL), `RUNTIME_TOKEN`, and `DOCUMENT_ID` environment variables to configure the server with the `-e` option in the `docker run` command. If not set, the defaults will be used. Refer to the [server configuration](/configure) for more details on the available environment variables and their defaults.

:::

You can also run the Jupyter MCP Server using Docker. Use the following command to start the server on **MacOS**.

```bash
docker run \
  -e DOCUMENT_URL="http://localhost:8888" \
  -p 4040:4040 \
  datalayer/jupyter-mcp-server:latest \
  --transport streamable-http
```

Use the following command to start the server on **Linux**.

```bash
docker run \
  --network=host \
  -e DOCUMENT_URL="http://localhost:8888" \
  -p 4040:4040 \
  datalayer/jupyter-mcp-server:latest \
  --transport streamable-http
```

<!--

## Run with Smithery

To install Jupyter MCP Server for Claude Desktop automatically via [Smithery](https://smithery.ai/server/@datalayer/jupyter-mcp-server):

```bash
npx -y @smithery/cli install @datalayer/jupyter-mcp-server --client claude
```

-->

### Configure your MCP Client

Use the following configuration for you MCP client to connect to a running Jupyter MCP Server.

```json
{
  "mcpServers": {
    "jupyter": {
        "command": "npx",
        "args": ["mcp-remote", "http://127.0.0.1:4040/mcp"]
    }
  }
}
```
